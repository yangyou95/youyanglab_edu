{% extends 'navbar.html' %}

{#{% load static from staticfiles %}#}
{% load static %}


{% block content %}

<link rel="stylesheet" href="{% static "webapp/detailpage.css" %}" type="text/css">

        <div class="row no-gutters">

      <div class="col-md-4 no-gutters">
        <div class="leftside">

          <div class = "return" >


          <a href="{% url 'webapp:course' lesson.chapter.course.id%}" class="btn-gradient purple mini"> < 返回 </a>
          </div>

          <div class = "bar">

              <div class="progress-text">课程进度 :</div>

            <div class="progress-bar purple" title="课程进度"> <span class="course" title="章节进度" style="width:60%;"> <span class="lesson" title="小节进度" style="width:50%"></span></span> </div>

          </div>

          <div class="category">

            <ul>

              {% for item in lesson.get_chapter_all_lessons%}
                {% if item.id == lesson.id%}
                  <div class="l" id="active"><div class="tag"></div><li><a href="{% url 'webapp:detailpage' item.id%}">{{item.lesson_name}}</a></li></div>
                {% else %}
                     <div class="l"><div class="tag"></div><li><a href="{% url 'webapp:detailpage' item.id%}">{{item.lesson_name}}</a></li></div>
                {% endif%}
              {% endfor %}

            </ul>


          </div>



          <!-- <ul class="nav nav-list"><li class="divider"></li></ul> -->




        </div>


      </div>

      <div class="col-md-8 no-gutters">

        <div class="ablock">

            <div class="intro"> <!--每个章节唯一的-->

            <h1>{{lesson.lesson_name}}</h1>


              <div class="spinner">
                <div class="rect1"></div>
                <div class="rect2"></div>
                <div class="rect3"></div>
                <div class="rect4"></div>
                <div class="rect5"></div>
              </div>


              <iframe src="//player.bilibili.com/player.html?aid=74809488&bvid=BV12E411i7Wk&cid=127970222&page=2" id="video" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="100%" height="600"> </iframe>

              <script>
                $(document).ready(function(){
                  $("iframe").hide();
                  $("iframe").load(function(){
                   $(".spinner").hide();
                   $("iframe").show();
                  });
                });
              </script>

            </div>

        </div>

        <div class="ablock">

        {% for question in lesson.classquestion_set.all %}
          <div class="content"><!--可添加的-->
            <div class="question">

                <h1>{{ question.question_text }}</h1>
            </div>

            <div class="choice">


              {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}




              <form>
                {% csrf_token %}
                {% for choice in question.classquestionchoice_set.all %}
                    <div>
                      <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.answer }}" onclick="myfunc(this.value)">
                      <label for="choice{{ forloop.counter }}" class="l1"></label>
                      <label for="choice{{ forloop.counter }}" class="l2">{{ choice.choice_text }}</label>
                      <label for="choice{{ forloop.counter }}" class="l3"></label>
                    </div>
                {% endfor %}
                <button id="pick" onclick ='jssubmit()' type="button" > 选择 </button>

                  <a id="continue" href="{% url 'webapp:detailpage' lesson.get_next.id %}"><button type="button"> 继续 ! </button></a>

                  <span id="demo"></span>

<!--               <input type="text" id="result">-->

                </form>

            </div>

              <!--<p id="demo"></p>-->

              <script type="text/javascript">

                //show result
                   $("#continue").hide();

                  var x = true;
                  function myfunc(choice) {

                      x = choice;
                      return x;
                  }

                  var result = document.getElementById("result").value;

                  function jssubmit() {        //获取form表单的dom对象

                    str = "";
                    document.getElementById("demo").innerText = str;

                    if(x == "True"){
                        str = "回答正确 !";
                        $("#pick").hide();
                        $("#continue").show();
                      }else{
                        str = "不对喔，再想一想呢";
                      }

                    index = 0;
                    setInterval(function() {  
                      if(index == str.length) { 
                       //清除定时器
                       clearInterval();
                       //若要让效果无限循环，把index归0即可
                       // index = 0;
                       }  
                        var a = document.getElementById("demo")
                        a.innerText = str.substring(0, index++);
                        },100)

                  }

              </script>

              </div>
            </div>

         {% endfor %}


        </div>


      </div>



{% endblock %}